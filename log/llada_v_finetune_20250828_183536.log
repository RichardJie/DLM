[2025-08-28 18:35:38,171] torch.distributed.run: [WARNING] 
[2025-08-28 18:35:38,171] torch.distributed.run: [WARNING] *****************************************
[2025-08-28 18:35:38,171] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2025-08-28 18:35:38,171] torch.distributed.run: [WARNING] *****************************************
[2025-08-28 18:35:42,041] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-28 18:35:42,041] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-28 18:35:42,042] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Please install pyav to use video processing functions.Please install pyav to use video processing functions.

Please install pyav to use video processing functions.
/hpc2hdd/home/yuxuanzhao/miniconda3/envs/dllm/lib/python3.9/site-packages/huggingface_hub/file_download.py:945: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/hpc2hdd/home/yuxuanzhao/miniconda3/envs/dllm/lib/python3.9/site-packages/huggingface_hub/file_download.py:945: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/hpc2hdd/home/yuxuanzhao/miniconda3/envs/dllm/lib/python3.9/site-packages/huggingface_hub/file_download.py:945: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
OpenCLIP not installed
OpenCLIP not installed
OpenCLIP not installed
[2025-08-28 18:36:01,632] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-08-28 18:36:01,633] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-08-28 18:36:01,640] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-08-28 18:36:01,641] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
You are using a model of type llava_llada to instantiate a model of type llada. This is not supported for all configurations of models and can yield errors.
Rank 0:  Overwriting config with {'use_pos_skipping': False, 'pos_skipping_range': 4096, 'mm_spatial_pool_mode': 'bilinear'}
You are using a model of type llava_llada to instantiate a model of type llada. This is not supported for all configurations of models and can yield errors.
You are using a model of type llava_llada to instantiate a model of type llada. This is not supported for all configurations of models and can yield errors.
Rank 0:  Loading vision tower: google/siglip2-so400m-patch14-384
[2025-08-28 18:36:14,080] [INFO] [partition_parameters.py:347:__exit__] finished initializing model - num_params = 1035, num_elems = 16.48B
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  5.21it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  5.17it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  5.90it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  5.31it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:04<00:06,  2.19s/it]Loading checkpoint shards:  50%|█████     | 3/6 [00:04<00:06,  2.20s/it]Loading checkpoint shards:  17%|█▋        | 1/6 [00:08<00:40,  8.05s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:10<00:07,  3.54s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:10<00:07,  3.54s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:11<00:21,  5.41s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:16<00:04,  4.34s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:16<00:04,  4.34s/it]Loading checkpoint shards:  50%|█████     | 3/6 [00:18<00:18,  6.14s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:27<00:14,  7.04s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:30<00:05,  5.73s/it]Loading checkpoint shards: 100%|██████████| 6/6 [00:33<00:00,  8.68s/it]Loading checkpoint shards: 100%|██████████| 6/6 [00:33<00:00,  5.57s/it]
Loading checkpoint shards: 100%|██████████| 6/6 [00:33<00:00,  8.68s/it]Loading checkpoint shards: 100%|██████████| 6/6 [00:33<00:00,  5.57s/it]
Loading checkpoint shards: 100%|██████████| 6/6 [00:35<00:00,  5.40s/it]Loading checkpoint shards: 100%|██████████| 6/6 [00:35<00:00,  5.87s/it]
Rank 0:  Adding LoRA adapters...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Rank 0:  Prompt version: llava_llada
Rank 0:  google/siglip2-so400m-patch14-384 is already loaded, `load_model` called again, skipping.
Rank 0:  Total parameters: ~8613.17 MB)
Rank 0:  Trainable parameters: ~189.28 MB)
Rank 0:  Loading data using traditional JSON format
Rank 0:  Loading /hpc2ssd/JH_DATA/spooler/yuxuanzhao/lijungang/wujie/LLaDA-V/dataset/vpp_sft_ready/vpp_sft_bbox_llava.json
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Rank 0:  Loaded 1186414 samples from /hpc2ssd/JH_DATA/spooler/yuxuanzhao/lijungang/wujie/LLaDA-V/dataset/vpp_sft_ready/vpp_sft_bbox_llava.json
Rank 0:  Loaded 1186414 samples from /hpc2ssd/JH_DATA/spooler/yuxuanzhao/lijungang/wujie/LLaDA-V/dataset/vpp_sft_ready/vpp_sft_bbox_llava.json
Rank 0:  Formatting inputs...Skip in lazy mode
Rank 0:  Setting NCCL timeout to INF to avoid running errors.
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Parameter Offload: Total persistent parameters: 663456 in 331 params
  0%|          | 0/24716 [00:00<?, ?it/s]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
  0%|          | 1/24716 [01:11<492:11:57, 71.69s/it]                                                     {'loss': 1.2555, 'grad_norm': 4.233281149515944, 'learning_rate': 1.3477088948787063e-07, 'epoch': 0.0}
  0%|          | 1/24716 [01:11<492:11:57, 71.69s/it]  0%|          | 2/24716 [02:21<483:08:57, 70.38s/it]                                                     {'loss': 1.3349, 'grad_norm': 4.483136972431723, 'learning_rate': 2.6954177897574125e-07, 'epoch': 0.0}
  0%|          | 2/24716 [02:21<483:08:57, 70.38s/it][2025-08-28 18:42:04,299] [WARNING] [stage3.py:1949:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 3/24716 [03:10<415:48:25, 60.57s/it]                                                     {'loss': 1.337, 'grad_norm': 3.581162276220109, 'learning_rate': 4.043126684636119e-07, 'epoch': 0.0}
  0%|          | 3/24716 [03:10<415:48:25, 60.57s/it]  0%|          | 4/24716 [03:50<361:30:42, 52.66s/it]                                                     {'loss': 1.3701, 'grad_norm': 5.529912537212207, 'learning_rate': 5.390835579514825e-07, 'epoch': 0.0}
  0%|          | 4/24716 [03:50<361:30:42, 52.66s/it]  0%|          | 5/24716 [04:40<353:54:43, 51.56s/it]                                                     {'loss': 1.4364, 'grad_norm': 5.1810416630868685, 'learning_rate': 6.738544474393532e-07, 'epoch': 0.0}
  0%|          | 5/24716 [04:40<353:54:43, 51.56s/it][2025-08-28 18:44:25,624] [WARNING] [stage3.py:1949:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 6/24716 [05:31<353:01:25, 51.43s/it]                                                     {'loss': 1.4254, 'grad_norm': 11.047286969506288, 'learning_rate': 8.086253369272238e-07, 'epoch': 0.0}
  0%|          | 6/24716 [05:31<353:01:25, 51.43s/it]  0%|          | 7/24716 [06:19<344:41:30, 50.22s/it]                                                     {'loss': 1.2063, 'grad_norm': 4.0277163822754956, 'learning_rate': 9.433962264150943e-07, 'epoch': 0.0}
  0%|          | 7/24716 [06:19<344:41:30, 50.22s/it]  0%|          | 8/24716 [07:01<327:15:37, 47.68s/it]                                                     {'loss': 1.3406, 'grad_norm': 4.260826389705586, 'learning_rate': 1.078167115902965e-06, 'epoch': 0.0}
  0%|          | 8/24716 [07:01<327:15:37, 47.68s/it]  0%|          | 9/24716 [07:46<321:40:17, 46.87s/it]                                                     {'loss': 1.6082, 'grad_norm': 4.420367045790542, 'learning_rate': 1.2129380053908356e-06, 'epoch': 0.0}
  0%|          | 9/24716 [07:46<321:40:17, 46.87s/it]  0%|          | 10/24716 [08:29<312:32:40, 45.54s/it]                                                      {'loss': 1.2143, 'grad_norm': 3.5526774665131318, 'learning_rate': 1.3477088948787064e-06, 'epoch': 0.0}
  0%|          | 10/24716 [08:29<312:32:40, 45.54s/it]  0%|          | 11/24716 [09:12<308:12:38, 44.91s/it]                                                      {'loss': 1.1831, 'grad_norm': 3.864519771700452, 'learning_rate': 1.482479784366577e-06, 'epoch': 0.0}
  0%|          | 11/24716 [09:12<308:12:38, 44.91s/it]  0%|          | 12/24716 [10:07<329:56:07, 48.08s/it]                                                      {'loss': 1.2345, 'grad_norm': 4.4491132092335235, 'learning_rate': 1.6172506738544475e-06, 'epoch': 0.0}
  0%|          | 12/24716 [10:07<329:56:07, 48.08s/it]  0%|          | 13/24716 [10:59<337:13:00, 49.14s/it]                                                      {'loss': 1.206, 'grad_norm': 3.866782293708342, 'learning_rate': 1.752021563342318e-06, 'epoch': 0.0}
  0%|          | 13/24716 [10:59<337:13:00, 49.14s/it]  0%|          | 14/24716 [12:00<362:10:02, 52.78s/it]                                                      {'loss': 1.3251, 'grad_norm': 4.309742090259601, 'learning_rate': 1.8867924528301887e-06, 'epoch': 0.0}
  0%|          | 14/24716 [12:00<362:10:02, 52.78s/it]  0%|          | 15/24716 [12:38<330:58:42, 48.24s/it]                                                      {'loss': 1.2869, 'grad_norm': 4.849755988515308, 'learning_rate': 2.0215633423180592e-06, 'epoch': 0.0}
  0%|          | 15/24716 [12:38<330:58:42, 48.24s/it]  0%|          | 16/24716 [13:27<332:41:28, 48.49s/it]                                                      {'loss': 1.1912, 'grad_norm': 23.27670274773017, 'learning_rate': 2.15633423180593e-06, 'epoch': 0.0}
  0%|          | 16/24716 [13:27<332:41:28, 48.49s/it]  0%|          | 17/24716 [14:19<340:21:27, 49.61s/it]                                                      {'loss': 1.1706, 'grad_norm': 6.582996583640834, 'learning_rate': 2.291105121293801e-06, 'epoch': 0.0}
  0%|          | 17/24716 [14:19<340:21:27, 49.61s/it]  0%|          | 18/24716 [15:02<325:44:51, 47.48s/it]                                                      {'loss': 1.1466, 'grad_norm': 3.4052341194851685, 'learning_rate': 2.425876010781671e-06, 'epoch': 0.0}
  0%|          | 18/24716 [15:02<325:44:51, 47.48s/it]  0%|          | 19/24716 [15:56<339:54:23, 49.55s/it]                                                      {'loss': 1.4238, 'grad_norm': 5.679030930016712, 'learning_rate': 2.560646900269542e-06, 'epoch': 0.0}
  0%|          | 19/24716 [15:56<339:54:23, 49.55s/it]  0%|          | 20/24716 [16:52<353:33:42, 51.54s/it]                                                      {'loss': 1.171, 'grad_norm': 4.229884204311907, 'learning_rate': 2.6954177897574127e-06, 'epoch': 0.0}
  0%|          | 20/24716 [16:52<353:33:42, 51.54s/it]  0%|          | 21/24716 [17:47<360:17:35, 52.52s/it]                                                      {'loss': 0.9527, 'grad_norm': 3.1338681835548448, 'learning_rate': 2.830188679245283e-06, 'epoch': 0.0}
  0%|          | 21/24716 [17:47<360:17:35, 52.52s/it]  0%|          | 22/24716 [18:34<348:44:29, 50.84s/it]                                                      {'loss': 1.1837, 'grad_norm': 5.5676091175507505, 'learning_rate': 2.964959568733154e-06, 'epoch': 0.0}
  0%|          | 22/24716 [18:34<348:44:29, 50.84s/it]  0%|          | 23/24716 [19:31<362:00:49, 52.78s/it]                                                      {'loss': 1.2033, 'grad_norm': 4.652424570914774, 'learning_rate': 3.0997304582210242e-06, 'epoch': 0.0}
  0%|          | 23/24716 [19:31<362:00:49, 52.78s/it]  0%|          | 24/24716 [20:33<379:58:11, 55.40s/it]                                                      {'loss': 1.0589, 'grad_norm': 3.7855842345508495, 'learning_rate': 3.234501347708895e-06, 'epoch': 0.0}
  0%|          | 24/24716 [20:33<379:58:11, 55.40s/it]  0%|          | 25/24716 [21:30<384:52:07, 56.11s/it]                                                      {'loss': 1.2344, 'grad_norm': 4.752003772749718, 'learning_rate': 3.3692722371967654e-06, 'epoch': 0.0}
  0%|          | 25/24716 [21:30<384:52:07, 56.11s/it]  0%|          | 26/24716 [22:24<380:11:13, 55.43s/it]                                                      {'loss': 1.3257, 'grad_norm': 4.445104166685598, 'learning_rate': 3.504043126684636e-06, 'epoch': 0.0}
  0%|          | 26/24716 [22:24<380:11:13, 55.43s/it]  0%|          | 27/24716 [23:27<396:04:33, 57.75s/it]                                                      {'loss': 1.1556, 'grad_norm': 4.033335302971536, 'learning_rate': 3.6388140161725074e-06, 'epoch': 0.0}
  0%|          | 27/24716 [23:28<396:04:33, 57.75s/it]  0%|          | 28/24716 [24:17<379:00:06, 55.27s/it]                                                      {'loss': 1.2428, 'grad_norm': 6.782857644403892, 'learning_rate': 3.7735849056603773e-06, 'epoch': 0.0}
  0%|          | 28/24716 [24:17<379:00:06, 55.27s/it]  0%|          | 29/24716 [25:07<369:10:17, 53.83s/it]                                                      {'loss': 1.313, 'grad_norm': 5.739782392461602, 'learning_rate': 3.908355795148248e-06, 'epoch': 0.0}
  0%|          | 29/24716 [25:07<369:10:17, 53.83s/it]  0%|          | 30/24716 [26:04<375:13:33, 54.72s/it]                                                      {'loss': 1.0015, 'grad_norm': 2.9359354749804, 'learning_rate': 4.0431266846361185e-06, 'epoch': 0.0}
  0%|          | 30/24716 [26:04<375:13:33, 54.72s/it]  0%|          | 31/24716 [26:44<344:54:27, 50.30s/it]                                                      {'loss': 1.1091, 'grad_norm': 3.62639516244011, 'learning_rate': 4.17789757412399e-06, 'epoch': 0.0}
  0%|          | 31/24716 [26:44<344:54:27, 50.30s/it]  0%|          | 32/24716 [27:28<330:57:18, 48.27s/it]                                                      {'loss': 1.288, 'grad_norm': 7.943556944519613, 'learning_rate': 4.31266846361186e-06, 'epoch': 0.0}
  0%|          | 32/24716 [27:28<330:57:18, 48.27s/it]  0%|          | 33/24716 [28:21<341:19:10, 49.78s/it]                                                      {'loss': 1.514, 'grad_norm': 10.085403218282735, 'learning_rate': 4.44743935309973e-06, 'epoch': 0.0}
  0%|          | 33/24716 [28:21<341:19:10, 49.78s/it]  0%|          | 34/24716 [29:10<340:19:02, 49.64s/it]                                                      {'loss': 1.0841, 'grad_norm': 3.734808325022864, 'learning_rate': 4.582210242587602e-06, 'epoch': 0.0}
  0%|          | 34/24716 [29:10<340:19:02, 49.64s/it]  0%|          | 35/24716 [30:04<348:12:21, 50.79s/it]                                                      {'loss': 0.9078, 'grad_norm': 3.121524325682321, 'learning_rate': 4.716981132075472e-06, 'epoch': 0.0}
  0%|          | 35/24716 [30:04<348:12:21, 50.79s/it]  0%|          | 36/24716 [30:59<357:08:49, 52.10s/it]                                                      {'loss': 0.9237, 'grad_norm': 4.193100554420296, 'learning_rate': 4.851752021563342e-06, 'epoch': 0.0}
  0%|          | 36/24716 [30:59<357:08:49, 52.10s/it]  0%|          | 37/24716 [31:45<345:18:26, 50.37s/it]                                                      {'loss': 0.728, 'grad_norm': 3.641443388116231, 'learning_rate': 4.9865229110512135e-06, 'epoch': 0.0}
  0%|          | 37/24716 [31:45<345:18:26, 50.37s/it]  0%|          | 38/24716 [32:28<330:10:58, 48.17s/it]                                                      {'loss': 0.7501, 'grad_norm': 2.5379754979661127, 'learning_rate': 5.121293800539084e-06, 'epoch': 0.0}
  0%|          | 38/24716 [32:28<330:10:58, 48.17s/it]  0%|          | 39/24716 [33:26<350:39:50, 51.16s/it]                                                      {'loss': 0.8553, 'grad_norm': 3.2638973870531145, 'learning_rate': 5.256064690026954e-06, 'epoch': 0.0}
  0%|          | 39/24716 [33:27<350:39:50, 51.16s/it]  0%|          | 40/24716 [34:08<329:50:29, 48.12s/it]                                                      {'loss': 0.7896, 'grad_norm': 6.2307634365057645, 'learning_rate': 5.3908355795148255e-06, 'epoch': 0.0}
  0%|          | 40/24716 [34:08<329:50:29, 48.12s/it]  0%|          | 41/24716 [34:56<331:05:04, 48.30s/it]                                                      {'loss': 0.9389, 'grad_norm': 5.292403533508689, 'learning_rate': 5.525606469002696e-06, 'epoch': 0.0}
  0%|          | 41/24716 [34:56<331:05:04, 48.30s/it]  0%|          | 42/24716 [35:42<325:33:34, 47.50s/it]                                                      {'loss': 0.6735, 'grad_norm': 2.4069582660598665, 'learning_rate': 5.660377358490566e-06, 'epoch': 0.0}
  0%|          | 42/24716 [35:42<325:33:34, 47.50s/it]  0%|          | 43/24716 [36:36<339:15:06, 49.50s/it]                                                      {'loss': 0.4931, 'grad_norm': 3.424906211466963, 'learning_rate': 5.7951482479784366e-06, 'epoch': 0.0}
  0%|          | 43/24716 [36:36<339:15:06, 49.50s/it]  0%|          | 44/24716 [37:12<311:30:35, 45.45s/it]                                                      {'loss': 0.7899, 'grad_norm': 4.138236288844034, 'learning_rate': 5.929919137466308e-06, 'epoch': 0.0}
  0%|          | 44/24716 [37:12<311:30:35, 45.45s/it]  0%|          | 45/24716 [37:55<306:17:03, 44.69s/it]                                                      {'loss': 0.5842, 'grad_norm': 2.564888878039047, 'learning_rate': 6.064690026954178e-06, 'epoch': 0.0}
  0%|          | 45/24716 [37:55<306:17:03, 44.69s/it]  0%|          | 46/24716 [38:41<309:57:49, 45.23s/it]                                                      {'loss': 0.4831, 'grad_norm': 1.9058476993063225, 'learning_rate': 6.1994609164420485e-06, 'epoch': 0.0}
  0%|          | 46/24716 [38:41<309:57:49, 45.23s/it]  0%|          | 47/24716 [39:14<284:04:17, 41.46s/it]                                                      {'loss': 0.4418, 'grad_norm': 1.5943341237162776, 'learning_rate': 6.334231805929919e-06, 'epoch': 0.0}
  0%|          | 47/24716 [39:14<284:04:17, 41.46s/it][2025-08-28 19:19:06,603] [WARNING] [stage3.py:1949:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 48/24716 [40:12<317:32:23, 46.34s/it]                                                      {'loss': 0.4339, 'grad_norm': 1.5533398360228141, 'learning_rate': 6.46900269541779e-06, 'epoch': 0.0}
  0%|          | 48/24716 [40:12<317:32:23, 46.34s/it]  0%|          | 49/24716 [40:55<310:58:53, 45.39s/it]                                                      {'loss': 0.4828, 'grad_norm': 2.579190548397434, 'learning_rate': 6.60377358490566e-06, 'epoch': 0.0}
  0%|          | 49/24716 [40:55<310:58:53, 45.39s/it]  0%|          | 50/24716 [42:02<355:22:58, 51.87s/it]                                                      {'loss': 0.5526, 'grad_norm': 2.0025192344452964, 'learning_rate': 6.738544474393531e-06, 'epoch': 0.0}
  0%|          | 50/24716 [42:02<355:22:58, 51.87s/it]  0%|          | 51/24716 [42:56<359:44:04, 52.51s/it]                                                      {'loss': 0.4369, 'grad_norm': 1.9613972755135476, 'learning_rate': 6.873315363881402e-06, 'epoch': 0.0}
  0%|          | 51/24716 [42:56<359:44:04, 52.51s/it]  0%|          | 52/24716 [43:44<349:44:01, 51.05s/it]                                                      {'loss': 0.3326, 'grad_norm': 1.21095374055953, 'learning_rate': 7.008086253369272e-06, 'epoch': 0.0}
  0%|          | 52/24716 [43:44<349:44:01, 51.05s/it]  0%|          | 53/24716 [44:25<329:50:17, 48.15s/it]                                                      {'loss': 0.7842, 'grad_norm': 4.819415219594653, 'learning_rate': 7.142857142857143e-06, 'epoch': 0.0}
  0%|          | 53/24716 [44:25<329:50:17, 48.15s/it]  0%|          | 54/24716 [45:20<343:57:51, 50.21s/it]                                                      {'loss': 0.3494, 'grad_norm': 1.4098770364453328, 'learning_rate': 7.277628032345015e-06, 'epoch': 0.0}
  0%|          | 54/24716 [45:20<343:57:51, 50.21s/it]  0%|          | 55/24716 [46:18<360:37:59, 52.65s/it]                                                      {'loss': 0.4945, 'grad_norm': 1.866327363238346, 'learning_rate': 7.412398921832884e-06, 'epoch': 0.0}
  0%|          | 55/24716 [46:18<360:37:59, 52.65s/it]  0%|          | 56/24716 [46:55<328:16:59, 47.92s/it]                                                      {'loss': 0.3671, 'grad_norm': 1.2983213370376103, 'learning_rate': 7.547169811320755e-06, 'epoch': 0.0}
  0%|          | 56/24716 [46:55<328:16:59, 47.92s/it]  0%|          | 57/24716 [47:43<327:49:24, 47.86s/it]                                                      {'loss': 0.3997, 'grad_norm': 2.5133726535094807, 'learning_rate': 7.681940700808626e-06, 'epoch': 0.0}
  0%|          | 57/24716 [47:43<327:49:24, 47.86s/it]  0%|          | 58/24716 [48:38<341:58:13, 49.93s/it]                                                      {'loss': 0.2656, 'grad_norm': 1.0271354866825588, 'learning_rate': 7.816711590296496e-06, 'epoch': 0.0}
  0%|          | 58/24716 [48:38<341:58:13, 49.93s/it]  0%|          | 59/24716 [49:14<314:31:12, 45.92s/it]                                                      {'loss': 0.3819, 'grad_norm': 1.7341991281932498, 'learning_rate': 7.951482479784367e-06, 'epoch': 0.0}
  0%|          | 59/24716 [49:14<314:31:12, 45.92s/it]  0%|          | 60/24716 [50:07<327:59:55, 47.89s/it]                                                      {'loss': 0.3292, 'grad_norm': 1.577168398499017, 'learning_rate': 8.086253369272237e-06, 'epoch': 0.0}
  0%|          | 60/24716 [50:07<327:59:55, 47.89s/it]  0%|          | 61/24716 [50:56<330:53:10, 48.31s/it]                                                      {'loss': 0.4326, 'grad_norm': 5.670304758100811, 'learning_rate': 8.221024258760109e-06, 'epoch': 0.0}
  0%|          | 61/24716 [50:56<330:53:10, 48.31s/it]  0%|          | 62/24716 [51:55<352:59:27, 51.54s/it]                                                      {'loss': 0.4344, 'grad_norm': 1.3428653407465556, 'learning_rate': 8.35579514824798e-06, 'epoch': 0.0}
  0%|          | 62/24716 [51:55<352:59:27, 51.54s/it]  0%|          | 63/24716 [52:46<350:52:57, 51.24s/it]                                                      {'loss': 0.3342, 'grad_norm': 1.388435935167147, 'learning_rate': 8.49056603773585e-06, 'epoch': 0.0}
  0%|          | 63/24716 [52:46<350:52:57, 51.24s/it]  0%|          | 64/24716 [53:36<347:54:00, 50.80s/it]                                                      {'loss': 0.3555, 'grad_norm': 1.5544640937740877, 'learning_rate': 8.62533692722372e-06, 'epoch': 0.0}
  0%|          | 64/24716 [53:36<347:54:00, 50.80s/it]  0%|          | 65/24716 [54:21<336:36:15, 49.16s/it]                                                      {'loss': 0.4713, 'grad_norm': 1.4157382662758558, 'learning_rate': 8.76010781671159e-06, 'epoch': 0.0}
  0%|          | 65/24716 [54:21<336:36:15, 49.16s/it]  0%|          | 66/24716 [55:15<347:19:05, 50.72s/it]                                                      {'loss': 0.3471, 'grad_norm': 1.7207586625782136, 'learning_rate': 8.89487870619946e-06, 'epoch': 0.0}
  0%|          | 66/24716 [55:15<347:19:05, 50.72s/it]  0%|          | 67/24716 [55:57<329:39:38, 48.15s/it]                                                      {'loss': 0.394, 'grad_norm': 3.2077764438440597, 'learning_rate': 9.029649595687333e-06, 'epoch': 0.0}
  0%|          | 67/24716 [55:57<329:39:38, 48.15s/it]  0%|          | 68/24716 [56:55<348:18:37, 50.87s/it]                                                      {'loss': 0.2542, 'grad_norm': 1.1653302215669352, 'learning_rate': 9.164420485175203e-06, 'epoch': 0.0}
  0%|          | 68/24716 [56:55<348:18:37, 50.87s/it]  0%|          | 69/24716 [57:46<348:35:38, 50.92s/it]                                                      {'loss': 0.2423, 'grad_norm': 1.595802715927269, 'learning_rate': 9.299191374663074e-06, 'epoch': 0.0}
  0%|          | 69/24716 [57:46<348:35:38, 50.92s/it]  0%|          | 70/24716 [58:43<362:12:36, 52.91s/it]                                                      {'loss': 0.3849, 'grad_norm': 1.2194676847230441, 'learning_rate': 9.433962264150944e-06, 'epoch': 0.0}
  0%|          | 70/24716 [58:43<362:12:36, 52.91s/it]  0%|          | 71/24716 [59:39<368:15:54, 53.79s/it]                                                      {'loss': 0.3859, 'grad_norm': 0.8647270829831427, 'learning_rate': 9.568733153638814e-06, 'epoch': 0.0}
  0%|          | 71/24716 [59:39<368:15:54, 53.79s/it]  0%|          | 72/24716 [1:00:28<358:16:13, 52.34s/it]                                                        {'loss': 0.3312, 'grad_norm': 1.9120311949883135, 'learning_rate': 9.703504043126685e-06, 'epoch': 0.0}
  0%|          | 72/24716 [1:00:28<358:16:13, 52.34s/it]  0%|          | 73/24716 [1:01:26<369:58:20, 54.05s/it]                                                        {'loss': 0.2948, 'grad_norm': 1.206664556006343, 'learning_rate': 9.838274932614555e-06, 'epoch': 0.0}
  0%|          | 73/24716 [1:01:26<369:58:20, 54.05s/it]  0%|          | 74/24716 [1:02:25<379:29:22, 55.44s/it]                                                        {'loss': 0.3284, 'grad_norm': 1.4398181456116104, 'learning_rate': 9.973045822102427e-06, 'epoch': 0.0}
  0%|          | 74/24716 [1:02:25<379:29:22, 55.44s/it]  0%|          | 75/24716 [1:03:16<371:27:20, 54.27s/it]                                                        {'loss': 0.3696, 'grad_norm': 1.283492144792829, 'learning_rate': 1.0107816711590297e-05, 'epoch': 0.0}
  0%|          | 75/24716 [1:03:16<371:27:20, 54.27s/it]  0%|          | 76/24716 [1:04:14<377:57:34, 55.22s/it]                                                        {'loss': 0.3366, 'grad_norm': 1.4832678896118432, 'learning_rate': 1.0242587601078168e-05, 'epoch': 0.0}
  0%|          | 76/24716 [1:04:14<377:57:34, 55.22s/it]  0%|          | 77/24716 [1:04:58<355:40:11, 51.97s/it]                                                        {'loss': 0.2785, 'grad_norm': 0.8198458371255872, 'learning_rate': 1.0377358490566038e-05, 'epoch': 0.0}
  0%|          | 77/24716 [1:04:58<355:40:11, 51.97s/it]  0%|          | 78/24716 [1:05:47<349:39:48, 51.09s/it]                                                        {'loss': 0.2653, 'grad_norm': 3.8656833134985593, 'learning_rate': 1.0512129380053909e-05, 'epoch': 0.0}
  0%|          | 78/24716 [1:05:47<349:39:48, 51.09s/it]  0%|          | 79/24716 [1:06:42<356:40:23, 52.12s/it]                                                        {'loss': 0.298, 'grad_norm': 1.9925052350968322, 'learning_rate': 1.0646900269541779e-05, 'epoch': 0.0}
  0%|          | 79/24716 [1:06:42<356:40:23, 52.12s/it]  0%|          | 80/24716 [1:07:38<365:50:36, 53.46s/it]                                                        {'loss': 0.3188, 'grad_norm': 0.902497893940393, 'learning_rate': 1.0781671159029651e-05, 'epoch': 0.0}
  0%|          | 80/24716 [1:07:38<365:50:36, 53.46s/it]  0%|          | 81/24716 [1:08:25<352:46:54, 51.55s/it]                                                        {'loss': 0.2865, 'grad_norm': 1.0986287821946672, 'learning_rate': 1.0916442048517521e-05, 'epoch': 0.0}
  0%|          | 81/24716 [1:08:25<352:46:54, 51.55s/it]  0%|          | 82/24716 [1:09:18<355:58:57, 52.02s/it]                                                        {'loss': 0.3537, 'grad_norm': 2.010693130375509, 'learning_rate': 1.1051212938005392e-05, 'epoch': 0.0}
  0%|          | 82/24716 [1:09:18<355:58:57, 52.02s/it]  0%|          | 83/24716 [1:10:09<353:56:10, 51.73s/it]                                                        {'loss': 0.2888, 'grad_norm': 0.8470648130963929, 'learning_rate': 1.1185983827493262e-05, 'epoch': 0.0}
  0%|          | 83/24716 [1:10:09<353:56:10, 51.73s/it]  0%|          | 84/24716 [1:10:56<343:27:19, 50.20s/it]                                                        {'loss': 0.2735, 'grad_norm': 0.9810154024097502, 'learning_rate': 1.1320754716981132e-05, 'epoch': 0.0}
  0%|          | 84/24716 [1:10:56<343:27:19, 50.20s/it]  0%|          | 85/24716 [1:11:41<333:10:51, 48.70s/it]                                                        {'loss': 0.2624, 'grad_norm': 1.327144509573058, 'learning_rate': 1.1455525606469003e-05, 'epoch': 0.0}
  0%|          | 85/24716 [1:11:41<333:10:51, 48.70s/it]  0%|          | 86/24716 [1:12:31<334:39:29, 48.91s/it]                                                        {'loss': 0.2773, 'grad_norm': 2.280070729553032, 'learning_rate': 1.1590296495956873e-05, 'epoch': 0.0}
  0%|          | 86/24716 [1:12:31<334:39:29, 48.91s/it]  0%|          | 87/24716 [1:13:34<364:20:54, 53.26s/it]                                                        {'loss': 0.2944, 'grad_norm': 1.3080732731841747, 'learning_rate': 1.1725067385444745e-05, 'epoch': 0.0}
  0%|          | 87/24716 [1:13:34<364:20:54, 53.26s/it]  0%|          | 88/24716 [1:14:19<347:56:26, 50.86s/it]                                                        {'loss': 0.2749, 'grad_norm': 2.4567200856398554, 'learning_rate': 1.1859838274932616e-05, 'epoch': 0.0}
  0%|          | 88/24716 [1:14:19<347:56:26, 50.86s/it]  0%|          | 89/24716 [1:14:57<320:51:17, 46.90s/it]                                                        {'loss': 0.3122, 'grad_norm': 1.7836552001417865, 'learning_rate': 1.1994609164420486e-05, 'epoch': 0.0}
  0%|          | 89/24716 [1:14:57<320:51:17, 46.90s/it]  0%|          | 90/24716 [1:16:01<354:59:15, 51.89s/it]                                                        {'loss': 0.3001, 'grad_norm': 1.2907532866861309, 'learning_rate': 1.2129380053908356e-05, 'epoch': 0.0}
  0%|          | 90/24716 [1:16:01<354:59:15, 51.89s/it]  0%|          | 91/24716 [1:16:44<338:16:28, 49.45s/it]                                                        {'loss': 0.2846, 'grad_norm': 1.6198382951452708, 'learning_rate': 1.2264150943396227e-05, 'epoch': 0.0}
  0%|          | 91/24716 [1:16:44<338:16:28, 49.45s/it]  0%|          | 92/24716 [1:17:31<331:55:22, 48.53s/it]                                                        {'loss': 0.2338, 'grad_norm': 0.9498508561568624, 'learning_rate': 1.2398921832884097e-05, 'epoch': 0.0}
  0%|          | 92/24716 [1:17:31<331:55:22, 48.53s/it]  0%|          | 93/24716 [1:18:08<309:00:59, 45.18s/it]                                                        {'loss': 0.2559, 'grad_norm': 1.0742637689895855, 'learning_rate': 1.2533692722371967e-05, 'epoch': 0.0}
  0%|          | 93/24716 [1:18:08<309:00:59, 45.18s/it]  0%|          | 94/24716 [1:18:54<311:19:51, 45.52s/it]                                                        {'loss': 0.4427, 'grad_norm': 2.4650376402413374, 'learning_rate': 1.2668463611859838e-05, 'epoch': 0.0}
  0%|          | 94/24716 [1:18:54<311:19:51, 45.52s/it]  0%|          | 95/24716 [1:19:38<308:08:28, 45.06s/it]                                                        {'loss': 0.3523, 'grad_norm': 3.5569616893373355, 'learning_rate': 1.2803234501347711e-05, 'epoch': 0.0}
  0%|          | 95/24716 [1:19:38<308:08:28, 45.06s/it]  0%|          | 96/24716 [1:20:38<337:09:09, 49.30s/it]                                                        {'loss': 0.2927, 'grad_norm': 0.772714352524344, 'learning_rate': 1.293800539083558e-05, 'epoch': 0.0}
  0%|          | 96/24716 [1:20:38<337:09:09, 49.30s/it]  0%|          | 97/24716 [1:21:24<332:06:43, 48.56s/it]                                                        {'loss': 0.2952, 'grad_norm': 1.0405207368203941, 'learning_rate': 1.307277628032345e-05, 'epoch': 0.0}
  0%|          | 97/24716 [1:21:24<332:06:43, 48.56s/it]  0%|          | 98/24716 [1:22:11<327:37:46, 47.91s/it]                                                        {'loss': 0.2857, 'grad_norm': 1.184196967600181, 'learning_rate': 1.320754716981132e-05, 'epoch': 0.0}
  0%|          | 98/24716 [1:22:11<327:37:46, 47.91s/it]  0%|          | 99/24716 [1:23:12<355:10:10, 51.94s/it]                                                        {'loss': 0.2515, 'grad_norm': 0.8835154862014428, 'learning_rate': 1.3342318059299191e-05, 'epoch': 0.0}
  0%|          | 99/24716 [1:23:12<355:10:10, 51.94s/it]  0%|          | 100/24716 [1:24:00<347:04:18, 50.76s/it]                                                         {'loss': 0.3022, 'grad_norm': 0.5770649420091981, 'learning_rate': 1.3477088948787062e-05, 'epoch': 0.0}
  0%|          | 100/24716 [1:24:00<347:04:18, 50.76s/it]  0%|          | 101/24716 [1:25:00<364:53:41, 53.37s/it]                                                         {'loss': 0.3425, 'grad_norm': 1.3658641292163294, 'learning_rate': 1.3611859838274935e-05, 'epoch': 0.0}
  0%|          | 101/24716 [1:25:00<364:53:41, 53.37s/it]